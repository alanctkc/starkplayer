(function(a){a.mediaplayer_id_counter=0;a.fn.extend({mediaplayer:function(b){var d={type:"",url:"",poster:"",youtubeid:"",width:"",height:"",autoplay:"false",buffertime:"10",border:"",bgcolor:"#ffffff",logo:"",quality:"default",skin:"default",videoplayer:"videoplayer.swf",audioplayer:"audioplayer.swf",youtubeplayer:"youtubeplayer.swf"};var b=a.extend(d,b);function c(e){var e=e.split("&").join("&amp;").split("<").join("&lt;").split('"').join("&quot;");var f=a("<div></div>").get(0);f.innerHTML='<a href="'+e+'">link</a>';return f.firstChild.href}return this.each(function(){var j=a.extend({},b);var l=a(this);if(parseInt(swfobject.getFlashPlayerVersion()["major"])<10){l.show();return}var g=a("<div></div>").attr("id","mediaplayer-"+a.mediaplayer_id_counter);l.wrap(g);a.mediaplayer_id_counter++;if(j.url==""&&l.get(0).tagName=="VIDEO"){if(l.attr("poster")){j.poster=c(l.attr("poster"))}if(l.attr("src")){j.url=c(l.attr("src"))}else{var f=l.find("source");if(f.length>0){var e=f.first();if(e.attr("src")){j.url=c(e.attr("src"))}}}if(j.type==""){j.type="video"}}if(j.url==""&&l.get(0).tagName=="AUDIO"){if(l.attr("src")){j.url=c(l.attr("src"))}else{var f=l.find("source");if(f.length>0){var e=f.first();if(e.attr("src")){j.url=c(e.attr("src"))}}}if(j.type==""){j.type="audio"}}if(j.url==""&&l.get(0).tagName=="A"){if(l.attr("href")){j.url=c(l.attr("href"))}var n=l.find("img");if(n.length>0){var m=n.first();if(m.attr("src")){j.poster=c(m.attr("src"))}}}if(j.url==""&&l.get(0).tagName=="IFRAME"){if(l.attr("src")){j.url=c(l.attr("src"))}}if(j.url==""&&l.get(0).tagName=="OBJECT"){var s=l.children("param");s.each(function(){var o=a(this);if(o.attr("name")=="movie"){j.url=o.attr("value")}});if(j.url==""){var h=l.find("embed");if(h.length>0){var p=h.first();if(p.attr("src")){j.url=p.attr("src")}}}}if(j.type==""&&j.url!==""){var i=/[^\?\#]*\.(.*?)((\?|\#)+?.*)*$/i.exec(j.url)[1];if(j.url.match(/^http\:\/\/(www\.){0,1}youtube\.com\//)){j.type="youtube"}else{if(i=="mp4"||i=="m4v"||i=="flv"||i=="mpg"||i=="mpeg"){j.type="video"}else{if(i=="mp3"){j.type="audio"}}}}if(j.url!==""&&j.type=="youtube"){j.youtubeid=/.*(\/embed\/|\/v\/|[\?\&\#\!]v\=)([a-zA-Z0-9]*).*$/i.exec(j.url)[2]}if(j.type=="youtube"&&j.youtubeid!==""&&l.get(0).tagName=="OBJECT"){l.css("display","block")}if(j.width==""){j.width=l.width()}if(j.height==""){j.height=l.height()}if(j.type=="audio"){if(j.skin=="compact"){j.width="260";j.height="30"}else{if(j.skin=="default"){j.width="320";j.height="70"}}}if(j.type=="video"){var q=j.videoplayer;var r={url:j.url,poster:j.poster,autoplay:j.autoplay,buffertime:j.buffertime,border:j.border,logo:j.logo};var k={allowFullScreen:"true",menu:"false"}}else{if(j.type=="audio"){var q=j.audioplayer;var r={url:j.url,autoplay:j.autoplay,border:j.border,skin:j.skin};var k={menu:"false",bgcolor:j.bgcolor}}else{if(j.type=="youtube"){var q=j.youtubeplayer;var r={id:j.youtubeid,autoplay:j.autoplay,border:j.border,quality:j.quality};var k={allowFullScreen:"true",menu:"false"}}}}if(j.type!==""&&(j.type!=="youtube"||(j.type=="youtube"&j.youtubeid!==""))){swfobject.embedSWF(q,g.attr("id"),j.width,j.height,"10.0.0",null,r,k,{id:g.attr("id"),name:g.attr("id")})}l.show()})}})})(jQuery);