(function(a){a.mediaplayer_id_counter=0;a.fn.extend({mediaplayer:function(b){if(parseInt(swfobject.getFlashPlayerVersion()["major"])<10){return}var d={type:"",url:"",poster:"",width:"",height:"",autoplay:"false",buffertime:"10",border:"",bgcolor:"#ffffff",logo:"",videoplayer:"videoplayer.swf",audioplayer:"audioplayer.swf"};var b=a.extend(d,b);function c(e){var e=e.split("&").join("&amp;").split("<").join("&lt;").split('"').join("&quot;");var f=a("<div></div>").get(0);f.innerHTML='<a href="'+e+'">link</a>';return f.firstChild.href}return this.each(function(){var h=a.extend({},b);var k=a(this);var g=a("<div></div>").attr("id","mediaplayer-"+a.mediaplayer_id_counter);k.wrap(g);a.mediaplayer_id_counter++;if(h.url==""&&k.get(0).tagName=="VIDEO"){if(k.attr("poster")){h.poster=c(k.attr("poster"))}if(k.attr("src")){h.url=c(k.attr("src"))}else{var f=k.find("source");if(f.length>0){var e=f.first();if(e.attr("src")){h.url=c(e.attr("src"))}}}if(h.type==""){h.type="video"}}if(h.url==""&&k.get(0).tagName=="AUDIO"){if(k.attr("src")){h.url=c(k.attr("src"))}else{var f=k.find("source");if(f.length>0){var e=f.first();if(e.attr("src")){h.url=c(e.attr("src"))}}}if(h.type==""){h.type="audio"}}if(h.url==""&&k.get(0).tagName=="A"){if(k.attr("href")){h.url=c(k.attr("href"))}var m=k.find("img");if(m.length>0){var l=m.first();if(l.attr("src")){h.poster=c(l.attr("src"))}}}if(h.type==""){var i=/[^\?\#]*\.(.*?)((\?|\#)+?.*)*$/i.exec(h.url)[1];if(i=="mp4"||i=="m4v"||i=="flv"||i=="mpg"||i=="mpeg"){h.type="video"}else{if(i=="mp3"){h.type="audio"}}}if(h.width==""){h.width=k.width()}if(h.height==""){h.height=k.height()}if(h.type=="audio"){h.width="320";h.height="70"}if(h.type=="video"){var n=h.videoplayer;var p={url:h.url,poster:h.poster,autoplay:h.autoplay,buffertime:h.buffertime,border:h.border,logo:h.logo};var j={allowFullScreen:"true",menu:"false"}}else{if(h.type=="audio"){var n=h.audioplayer;var p={url:h.url,autoplay:h.autoplay,border:h.border};var j={menu:"false",bgcolor:h.bgcolor}}}if(h.type!==""){swfobject.embedSWF(n,g.attr("id"),h.width,h.height,"10.0.0",null,p,j,{id:g.attr("id"),name:g.attr("id")})}})}})})(jQuery);