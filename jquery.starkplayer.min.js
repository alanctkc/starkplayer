(function(a){a.starkplayer_id_counter=0;a.fn.extend({starkplayer:function(b){var d={type:"",url:"",poster:"",youtubeid:"",width:"",height:"",autoplay:"false",buffertime:"10",border:"",bgcolor:"#ffffff",logo:"",quality:"default",videoplayer:"videoplayer.swf",audioplayer:"audioplayer.swf",youtubeplayer:"youtubeplayer.swf"};var b=a.extend(d,b);function c(e){var e=e.split("&").join("&amp;").split("<").join("&lt;").split('"').join("&quot;");var f=a("<div></div>").get(0);f.innerHTML='<a href="'+e+'">link</a>';return f.firstChild.href}return this.each(function(){var i=a.extend({},b);var k=a(this);if(parseInt(swfobject.getFlashPlayerVersion()["major"])<10){k.show();return}var g=a("<div></div>").attr("id","starkplayer-"+a.starkplayer_id_counter);k.wrap(g);a.starkplayer_id_counter++;if(i.url==""&&k.get(0).tagName=="VIDEO"){if(i.poster==""&&k.attr("poster")){i.poster=c(k.attr("poster"))}if(k.attr("src")){i.url=c(k.attr("src"))}else{var f=k.find("source");if(f.length>0){var e=f.first();if(e.attr("src")){i.url=c(e.attr("src"))}}}if(i.width==""&&k.attr("width")){i.width=k.attr("width")}if(i.height==""&&k.attr("height")){i.height=k.attr("height")}if(i.type==""){i.type="video"}}if(i.url==""&&k.get(0).tagName=="AUDIO"){if(k.attr("src")){i.url=c(k.attr("src"))}else{var f=k.find("source");if(f.length>0){var e=f.first();if(e.attr("src")){i.url=c(e.attr("src"))}}}if(i.type==""){i.type="audio"}}if(i.url==""&&k.get(0).tagName=="A"){if(k.attr("href")){i.url=c(k.attr("href"))}var m=k.find("img");if(m.length>0){var l=m.first();if(i.poster==""&&l.attr("src")){i.poster=c(l.attr("src"))}}}if(i.url==""&&k.get(0).tagName=="IFRAME"){if(k.attr("src")){i.url=c(k.attr("src"))}if(i.width==""&&k.attr("width")){i.width=k.attr("width")}if(i.height==""&&k.attr("height")){i.height=k.attr("height")}}if(i.url==""&&k.get(0).tagName=="OBJECT"){var r=k.children("param");r.each(function(){var o=a(this);if(o.attr("name")=="movie"){i.url=o.attr("value")}});if(i.width==""&&k.attr("width")){i.width=k.attr("width")}if(i.height==""&&k.attr("height")){i.height=k.attr("height")}}if(i.url==""&&k.get(0).tagName=="EMBED"){if(k.attr("src")){i.url=k.attr("src")}if(i.width==""&&k.attr("width")){i.width=k.attr("width")}if(i.height==""&&k.attr("height")){i.height=k.attr("height")}}if(i.type==""&&i.url!==""){var h=/[^\?\#]*\.(.*?)((\?|\#)+?.*)*$/i.exec(i.url)[1];if(i.url.match(/^http\:\/\/(www\.){0,1}youtube\.com\//)){i.type="youtube"}else{if(h=="mp4"||h=="m4v"||h=="flv"||h=="mpg"||h=="mpeg"||h=="mov"||h=="3gp"){i.type="video"}else{if(h=="mp3"){i.type="audio"}}}}if(i.youtubeid==""&&i.url!==""&&i.type=="youtube"){i.youtubeid=/.*(\/embed\/|\/v\/|[\?\&\#\!]v\=)([a-zA-Z0-9\_]*).*$/i.exec(i.url)[2]}if(i.type=="audio"){if(i.width==""){i.width="260"}if(i.height==""){i.height="30"}}var n=k.css("display");k.css("display","block");if(i.width==""){i.width=k.width()}if(i.height==""){i.height=k.height()}k.css("display",n);if(i.type=="video"){var p=i.videoplayer;var q={url:i.url,poster:i.poster,autoplay:i.autoplay,buffertime:i.buffertime,border:i.border,logo:i.logo};var j={allowFullScreen:"true",menu:"false"}}else{if(i.type=="audio"){var p=i.audioplayer;var q={url:i.url,autoplay:i.autoplay,border:i.border};var j={menu:"false",bgcolor:i.bgcolor}}else{if(i.type=="youtube"){var p=i.youtubeplayer;var q={id:i.youtubeid,autoplay:i.autoplay,border:i.border,quality:i.quality,logo:i.logo};var j={allowFullScreen:"true",menu:"false"}}}}if(i.type!==""&&(i.type!=="youtube"||(i.type=="youtube"&i.youtubeid!==""))){swfobject.embedSWF(p,g.attr("id"),i.width,i.height,"10.0.0",null,q,j,{id:g.attr("id"),name:g.attr("id")})}k.show()})}})})(jQuery);