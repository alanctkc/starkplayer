(function(a){a.starkplayer_id_counter=0;a.html5_fix_counter=0;a.fn.extend({starkplayer:function(c){var g={type:"",url:"",poster:"",youtubeid:"",width:"",height:"",autoplay:"false",buffertime:"10",border:"",bgcolor:"#ffffff",logo:"",quality:"default",videoplayer:"videoplayer.swf",audioplayer:"audioplayer.swf",youtubeplayer:"youtubeplayer.swf"};var c=a.extend(g,c);function d(i){var i=i.split("&").join("&amp;").split("<").join("&lt;").split('"').join("&quot;");var j=a("<div></div>").get(0);j.innerHTML='<a href="'+i+'">link</a>';return j.firstChild.href}function f(j,l,m,p){var i=j.tagName;var o=j.nextSibling;var n=a("<div></div>");while(o&&o.tagName!==m&&o.tagName!==i){if(o.tagName=="SOURCE"){o=b(o,p).get(0)}a(o).clone().appendTo(n);var k=o.nextSibling;a(o).remove();o=k}if(o&&o.tagName==m){a(o).remove()}a.each(j.attributes,function(q,r){a(n).attr(r.name,r.value)});n.addClass(l).addClass("html5-fix-"+a.html5_fix_counter).insertAfter(j);a(j).attr("rel",".html5-fix-"+a.html5_fix_counter);a.html5_fix_counter++;a(j).remove();return n}function b(i,k){var j=a("<span></span>");a.each(i.attributes,function(l,m){j.attr(m.name,m.value)});j.addClass(k).insertAfter(i);a(i).remove();return j}var e=false;a("*").each(function(){if(this.tagName=="/AUDIO"){e=true}if(this.tagName=="/VIDEO"){e=true}});if(e){var h=0;a("audio").each(function(){f(this,"html5-audio","/AUDIO","html5-source")});a("video").each(function(){f(this,"html5-video","/VIDEO","html5-source")})}return this.each(function(){var n=a.extend({},c);var q=a(this);if(e&&(q.get(0).tagName=="AUDIO"||q.get(0).tagName=="VIDEO")){q=a(q.attr("rel"))}if(parseInt(swfobject.getFlashPlayerVersion()["major"])<10){q.show();return}var k=a("<div></div>").attr("id","starkplayer-"+a.starkplayer_id_counter);q.wrap(k);a.starkplayer_id_counter++;if(n.url==""&&(q.get(0).tagName=="AUDIO"||q.hasClass("html5-audio"))){if(q.attr("src")){n.url=d(q.attr("src"))}else{var j=q.find("source, .html5-source");if(j.length>0){var i=j.first();if(i.attr("src")){n.url=d(i.attr("src"))}}}if(n.type==""){n.type="audio"}}if(n.url==""&&(q.get(0).tagName=="VIDEO"||q.hasClass("html5-video"))){if(n.poster==""&&q.attr("poster")){n.poster=d(q.attr("poster"))}if(q.attr("src")){n.url=d(q.attr("src"))}else{var j=q.find("source, .html5-source");if(j.length>0){var i=j.first();if(i.attr("src")){n.url=d(i.attr("src"))}}}if(n.width==""&&q.attr("width")){n.width=q.attr("width")}if(n.height==""&&q.attr("height")){n.height=q.attr("height")}if(n.type==""){n.type="video"}}if(n.url==""&&q.get(0).tagName=="A"){if(q.attr("href")){n.url=d(q.attr("href"))}var s=q.find("img");if(s.length>0){var r=s.first();if(n.poster==""&&r.attr("src")){n.poster=d(r.attr("src"))}}}if(n.url==""&&q.get(0).tagName=="IFRAME"){if(q.attr("src")){n.url=d(q.attr("src"))}if(n.width==""&&q.attr("width")){n.width=q.attr("width")}if(n.height==""&&q.attr("height")){n.height=q.attr("height")}}if(n.url==""&&q.get(0).tagName=="OBJECT"){var x=q.children("param");x.each(function(){var o=a(this);if(o.attr("name")=="movie"){n.url=o.attr("value")}});if(n.width==""&&q.attr("width")){n.width=q.attr("width")}if(n.height==""&&q.attr("height")){n.height=q.attr("height")}if(n.url==""){var l=q.children("embed");if(l.length>0){var t=l.first();if(t.attr("src")){n.url=t.attr("src")}if(n.width==""&&t.attr("width")){n.width=t.attr("width")}if(n.height==""&&t.attr("height")){n.height=t.attr("height")}}}}if(n.type==""&&n.url!==""){var m=/[^\?\#]*\.(.*?)((\?|\#)+?.*)*$/i.exec(n.url)[1];if(n.url.match(/^http\:\/\/(www\.){0,1}youtube\.com\//)){n.type="youtube"}else{if(m=="mp4"||m=="m4v"||m=="flv"||m=="mpg"||m=="mpeg"||m=="mov"||m=="3gp"){n.type="video"}else{if(m=="mp3"){n.type="audio"}}}}if(n.youtubeid==""&&n.url!==""&&n.type=="youtube"){n.youtubeid=/.*(\/embed\/|\/v\/|[\?\&\#\!]v\=)([a-zA-Z0-9\_]*).*$/i.exec(n.url)[2]}if(n.type=="audio"){if(n.width==""){n.width="260"}if(n.height==""){n.height="30"}}var u=q.css("display");q.css("display","block");if(n.width==""){n.width=q.width()}if(n.height==""){n.height=q.height()}q.css("display",u);if(n.type=="video"){var v=n.videoplayer;var w={url:n.url,poster:n.poster,autoplay:n.autoplay,buffertime:n.buffertime,border:n.border,logo:n.logo};var p={allowFullScreen:"true",menu:"false"}}else{if(n.type=="audio"){var v=n.audioplayer;var w={url:n.url,autoplay:n.autoplay,border:n.border};var p={menu:"false",bgcolor:n.bgcolor}}else{if(n.type=="youtube"){var v=n.youtubeplayer;var w={id:n.youtubeid,autoplay:n.autoplay,border:n.border,quality:n.quality,logo:n.logo};var p={allowFullScreen:"true",menu:"false"}}}}if(n.type!==""&&(n.type!=="youtube"||(n.type=="youtube"&n.youtubeid!==""))){swfobject.embedSWF(v,k.attr("id"),n.width,n.height,"10.0.0",null,w,p,{id:k.attr("id"),name:k.attr("id")})}q.show()})}})})(jQuery);