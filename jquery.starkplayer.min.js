(function(a){a.starkplayer_id_counter=0;a.fn.extend({starkplayer:function(c){var g={type:"",url:"",poster:"",youtubeid:"",width:"",height:"",autoplay:"false",buffertime:"10",border:"",bgcolor:"#ffffff",logo:"",quality:"default",videoplayer:"videoplayer.swf",audioplayer:"audioplayer.swf",youtubeplayer:"youtubeplayer.swf"};var c=a.extend(g,c);function d(h){var h=h.split("&").join("&amp;").split("<").join("&lt;").split('"').join("&quot;");var i=a("<div></div>").get(0);i.innerHTML='<a href="'+h+'">link</a>';return i.firstChild.href}function f(i,k,l,o){var h=i.tagName;var n=i.nextSibling;var m=a("<div></div>");while(n&&n.tagName!==l&&n.tagName!==h){if(n.tagName=="SOURCE"){n=b(n,o).get(0)}a(n).clone().appendTo(m);var j=n.nextSibling;a(n).remove();n=j}if(n&&n.tagName==l){a(n).remove()}a.each(i.attributes,function(p,q){a(m).attr(q.name,q.value)});m.addClass(k).insertAfter(i);a(i).remove();return m}function b(h,j){var i=a("<span></span>");a.each(h.attributes,function(k,l){i.attr(l.name,l.value)});i.addClass(j).insertAfter(h);a(h).remove();return i}var e=false;a("*").each(function(){if(this.tagName=="/AUDIO"){e=true}if(this.tagName=="/VIDEO"){e=true}});return this.each(function(){var m=a.extend({},c);var p=a(this);if(e){if(p.get(0).tagName=="AUDIO"){p=f(this,"html5-audio","/AUDIO","html5-source")}if(p.get(0).tagName=="VIDEO"){p=f(this,"html5-video","/VIDEO","html5-source")}}if(parseInt(swfobject.getFlashPlayerVersion()["major"])<10){p.show();return}var j=a("<div></div>").attr("id","starkplayer-"+a.starkplayer_id_counter);p.wrap(j);a.starkplayer_id_counter++;if(m.url==""&&(p.get(0).tagName=="AUDIO"||p.hasClass("html5-audio"))){if(p.attr("src")){m.url=d(p.attr("src"))}else{var i=p.find("source, .html5-source");if(i.length>0){var h=i.first();if(h.attr("src")){m.url=d(h.attr("src"))}}}if(m.type==""){m.type="audio"}}if(m.url==""&&(p.get(0).tagName=="VIDEO"||p.hasClass("html5-video"))){if(m.poster==""&&p.attr("poster")){m.poster=d(p.attr("poster"))}if(p.attr("src")){m.url=d(p.attr("src"))}else{var i=p.find("source, .html5-source");if(i.length>0){var h=i.first();if(h.attr("src")){m.url=d(h.attr("src"))}}}if(m.width==""&&p.attr("width")){m.width=p.attr("width")}if(m.height==""&&p.attr("height")){m.height=p.attr("height")}if(m.type==""){m.type="video"}}if(m.url==""&&p.get(0).tagName=="A"){if(p.attr("href")){m.url=d(p.attr("href"))}var r=p.find("img");if(r.length>0){var q=r.first();if(m.poster==""&&q.attr("src")){m.poster=d(q.attr("src"))}}}if(m.url==""&&p.get(0).tagName=="IFRAME"){if(p.attr("src")){m.url=d(p.attr("src"))}if(m.width==""&&p.attr("width")){m.width=p.attr("width")}if(m.height==""&&p.attr("height")){m.height=p.attr("height")}}if(m.url==""&&p.get(0).tagName=="OBJECT"){var w=p.children("param");w.each(function(){var o=a(this);if(o.attr("name")=="movie"){m.url=o.attr("value")}});if(m.width==""&&p.attr("width")){m.width=p.attr("width")}if(m.height==""&&p.attr("height")){m.height=p.attr("height")}if(m.url==""){var k=p.children("embed");if(k.length>0){var s=k.first();if(s.attr("src")){m.url=s.attr("src")}if(m.width==""&&s.attr("width")){m.width=s.attr("width")}if(m.height==""&&s.attr("height")){m.height=s.attr("height")}}}}if(m.type==""&&m.url!==""){var l=/[^\?\#]*\.(.*?)((\?|\#)+?.*)*$/i.exec(m.url)[1];if(m.url.match(/^http\:\/\/(www\.){0,1}youtube\.com\//)){m.type="youtube"}else{if(l=="mp4"||l=="m4v"||l=="flv"||l=="mpg"||l=="mpeg"||l=="mov"||l=="3gp"){m.type="video"}else{if(l=="mp3"){m.type="audio"}}}}if(m.youtubeid==""&&m.url!==""&&m.type=="youtube"){m.youtubeid=/.*(\/embed\/|\/v\/|[\?\&\#\!]v\=)([a-zA-Z0-9\_]*).*$/i.exec(m.url)[2]}if(m.type=="audio"){if(m.width==""){m.width="260"}if(m.height==""){m.height="30"}}var t=p.css("display");p.css("display","block");if(m.width==""){m.width=p.width()}if(m.height==""){m.height=p.height()}p.css("display",t);if(m.type=="video"){var u=m.videoplayer;var v={url:m.url,poster:m.poster,autoplay:m.autoplay,buffertime:m.buffertime,border:m.border,logo:m.logo};var n={allowFullScreen:"true",menu:"false"}}else{if(m.type=="audio"){var u=m.audioplayer;var v={url:m.url,autoplay:m.autoplay,border:m.border};var n={menu:"false",bgcolor:m.bgcolor}}else{if(m.type=="youtube"){var u=m.youtubeplayer;var v={id:m.youtubeid,autoplay:m.autoplay,border:m.border,quality:m.quality,logo:m.logo};var n={allowFullScreen:"true",menu:"false"}}}}if(m.type!==""&&(m.type!=="youtube"||(m.type=="youtube"&m.youtubeid!==""))){swfobject.embedSWF(u,j.attr("id"),m.width,m.height,"10.0.0",null,v,n,{id:j.attr("id"),name:j.attr("id")})}p.show()})}})})(jQuery);